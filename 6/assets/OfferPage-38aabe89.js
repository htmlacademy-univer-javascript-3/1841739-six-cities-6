import{r as s,j as e,F as p,b as _}from"./index-a384292f.js";import{H as w}from"./Header-41d5a621.js";import{g as h,a as x,O as j}from"./offers-3de05a40.js";import{a as b}from"./CityMap-20f8b07e.js";const N=s.memo(n=>{const{id:t,onPost:r}=n,[a,m]=s.useState({rating:0,comment:""}),i=_(!0),o=s.useCallback(c=>{c.stopPropagation(),c.preventDefault(),console.log("submitHandler",t),i&&(r==null||r({rating:a.rating,comment:a.comment,date:new Date().toISOString(),user:i,id:`${Math.random()}`}))},[i,t,r,a.comment,a.rating]),l=s.useCallback(c=>{const d=c.target.value;m(f=>({...f,comment:d}))},[]),g=s.useCallback(c=>{m(d=>({...d,rating:c}))},[]),v=s.useMemo(()=>!(a.rating===0||!a.comment||a.comment.length<50),[a.comment,a.rating]);return!i||!t?null:e.jsxs("form",{className:"reviews__form form",action:"#",method:"post",onSubmit:o,children:[e.jsx("label",{className:"reviews__label form__label",htmlFor:"review",children:"Your review"}),e.jsx(p,{className:"reviews__rating-form ",onChange:g}),e.jsx("textarea",{onChange:l,className:"reviews__textarea form__textarea",id:"review",name:"review",value:a.comment,placeholder:"Tell how was your stay, what you like and what can be improved"}),e.jsxs("div",{className:"reviews__button-wrapper",children:[e.jsxs("p",{className:"reviews__help",children:["To submit review please make sure to set"," ",e.jsx("span",{className:"reviews__star",children:"rating"})," and describe your stay with at least"," ",e.jsx("b",{className:"reviews__text-amount",children:"50 characters"}),"."]}),e.jsx("button",{className:"reviews__submit form__submit button",type:"submit",disabled:!v,children:"Submit"})]})]})});function u(n){const t=new Date(n),r=["January","February","March","April","May","June","July","August","September","October","November","December"],a=t.getFullYear(),m=r[t.getMonth()],i=t.toISOString().split("T")[0];return{month:m,year:a,dateTime:i,mothYear:`${m} ${a}`}}const y=s.memo(n=>{const{reviews:t}=n,r=s.useCallback(a=>20*a,[]);return t.length===0?null:e.jsx("ul",{className:"reviews__list",children:t.map(a=>e.jsxs("li",{className:"reviews__item",children:[e.jsxs("div",{className:"reviews__user user",children:[e.jsx("div",{className:"reviews__avatar-wrapper user__avatar-wrapper",children:e.jsx("img",{className:"reviews__avatar user__avatar",src:a.user.avatarUrl,width:"54",height:"54",alt:"Reviews avatar"})}),e.jsx("span",{className:"reviews__user-name",children:a.user.name})]}),e.jsxs("div",{className:"reviews__info",children:[e.jsx("div",{className:"reviews__rating rating",children:e.jsxs("div",{className:"reviews__stars rating__stars",children:[e.jsx("span",{style:{width:`${r(a.rating)}%`}}),e.jsx("span",{className:"visually-hidden",children:"Rating"})]})}),e.jsxs("p",{className:"reviews__text",children:["$",a.comment]}),e.jsx("time",{className:"reviews__time",dateTime:u(a.date).dateTime,children:u(a.date).mothYear})]})]},a.id))})}),O=()=>[{id:"b67ddfd5-b953-4a30-8c8d-bd083cd6b62a",date:"2019-05-08T14:13:56.569Z",user:{name:"Oliver Conner",avatarUrl:"https://url-to-image/image.png",isPro:!1},comment:"A quiet cozy and picturesque that hides behind a a river by the unique lightness of Amsterdam.",rating:4},{id:"c78eefg6-c064-5b41-9d9e-ce194de7c73b",date:"2020-03-15T10:25:33.741Z",user:{name:"Sarah Johnson",avatarUrl:"img/avatar-max.jpg",isPro:!0},comment:"Amazing place with great location and wonderful host. Highly recommended for anyone visiting the city.",rating:5},{id:"d89ffgh7-d175-6c52-ae0f-df205ef8d84c",date:"2021-07-22T18:42:17.892Z",user:{name:"Mike Wilson",avatarUrl:"img/avatar-max.jpg",isPro:!1},comment:"Good value for money. The apartment was clean and well-equipped. Only minor issue was the noise from the street.",rating:3},{id:"e90gghh8-e286-7d63-bf1g-eg316fg9e95d",date:"2022-11-30T12:18:44.123Z",user:{name:"Emma Davis",avatarUrl:"img/avatar-max.jpg",isPro:!0},comment:"Perfect stay! Everything was as described. The host was very responsive and helpful. Will definitely come back.",rating:5},{id:"f01hhii9-f397-8e74-cg2h-fh427gh0fa6e",date:"2023-01-12T09:55:28.456Z",user:{name:"James Brown",avatarUrl:"img/avatar-max.jpg",isPro:!1},comment:"Nice place but could use some updates. The location is convenient for exploring the city center.",rating:3}],T=s.memo(n=>{const{id:t}=n,[r,a]=s.useState([]);s.useEffect(()=>{a(O())},[t]);const m=s.useCallback(i=>{a(o=>[...o,i])},[]);return e.jsxs("section",{className:"offer__reviews reviews",children:[e.jsxs("h2",{className:"reviews__title",children:["Reviews Â·"," ",e.jsx("span",{className:"reviews__amount",children:r.length})]}),e.jsx(y,{reviews:r}),e.jsx(N,{id:t,onPost:m})]})}),A=s.memo(()=>{const[n,t]=s.useState([]),[r,a]=s.useState(null),m=s.useCallback(l=>{a(l)},[]);s.useEffect(()=>{t(h())},[]);const[i,o]=s.useState({...h()[0],description:"A quiet cozy and picturesque that hides behind a a river by the unique lightness of Amsterdam. The building is green and from 18th century.",bedrooms:3,goods:["Wi-Fi","Washing machine","Towels","Heating","Coffee machine","Baby seat","Kitchen","Dishwasher","Cabel TV","Fridge"],host:{avatarUrl:"img/avatar-angelina.jpg",isPro:!0,name:"Angelina"},images:["img/room.jpg","img/apartment-01.jpg","img/apartment-02.jpg","img/apartment-03.jpg","img/studio-01.jpg","img/apartment-01.jpg"],maxAdults:4});return e.jsxs("div",{className:"page",children:[e.jsx(w,{}),e.jsxs("main",{className:"page__main page__main--offer",children:[e.jsx(x,{offer:i,reviews:e.jsx(T,{id:i.id})}),e.jsx("section",{className:"offer__map map",children:e.jsx(b,{city:i.city.name,offers:n,selectedOffer:r})}),e.jsx("div",{className:"container",children:e.jsxs("section",{className:"near-places places",children:[e.jsx("h2",{className:"near-places__title",children:"Other places in the neighbourhood"}),e.jsx("div",{className:"near-places__list places__list",children:e.jsx(j,{offers:n,onActiveOffer:m})})]})})]})]})});export{A as default};
