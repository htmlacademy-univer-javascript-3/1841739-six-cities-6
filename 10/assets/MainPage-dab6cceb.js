import{R as d,u as b,c as C,a as j,r as i,C as h,b as O,d as v,g as f,j as e,L as P,e as p,f as S,h as R,O as k}from"./index-d1a95681.js";import{H as w}from"./Header-fe74c8c0.js";import{C as E}from"./CityMap-9cda2732.js";function N(s=d){const a=s===d?b:C(s);return function(){const{store:c}=a();return c}}const H=N();function A(s=d){const a=s===d?H:N(s);return function(){return a().dispatch}}const $=A(),D=s=>s.city.name;function g(){return j(D)}const I=s=>s.offer.availableOffers;function L(){return j(I)}const y=()=>$(),x=i.memo(()=>{const s=Object.values(h),a=O(),t=g(),[c]=v(),{setCity:r}=S,l=y();return i.useEffect(()=>{if(c){const n=c.get("city");n&&l(r(n))}},[c,r]),i.useEffect(()=>{t||a(`${f()}?city=${h.Paris}`)},[t,a]),e.jsx("div",{className:"tabs",children:e.jsx("section",{className:"locations container",children:e.jsx("ul",{className:"locations__list tabs__list",children:s.map(n=>e.jsx("li",{className:"locations__item",children:e.jsx(P,{className:p("locations__item-link","tabs__item",{"tabs__item--active":t===n}),to:`${f()}?city=${n}`,children:e.jsx("span",{children:n})})},n))})})})}),M=(s,a)=>{i.useEffect(()=>{const t=c=>{s.current&&!s.current.contains(c.target)&&a()};return document.addEventListener("mousedown",t),()=>{document.removeEventListener("mousedown",t)}},[s,a])},m=[{label:"Popular",value:"popular-desc"},{label:"Price: low to high",value:"price-asc"},{label:"Price: high to low",value:"price-desc"},{label:"Top rated first",value:"top-desc"}],T=i.memo(()=>{const[s,a]=i.useState(!1),t=i.useRef(null),[c,r]=v(),l=i.useMemo(()=>m.find(u=>c.get("sort-by")===u.value)||m[0],[c]);M(t,()=>{s&&a(!1)});const n=i.useCallback(o=>{a(!1),r(u=>{const _=new URLSearchParams(u);return _.set("sort-by",o),_})},[r]);return e.jsxs("form",{className:"places__sorting",action:"#",method:"get",children:[e.jsx("span",{className:"places__sorting-caption",children:"Sort by"}),e.jsxs("span",{className:"places__sorting-type",tabIndex:0,onClick:()=>a(o=>!o),children:[l.label,e.jsx("svg",{className:"places__sorting-arrow",width:"7",height:"4",children:e.jsx("use",{xlinkHref:"#icon-arrow-select"})})]}),e.jsx("ul",{className:p("places__options","places__options--custom",{"places__options--opened":s}),ref:t,children:m.map(o=>e.jsx("li",{onClick:()=>n(o.value),className:p("places__option",{"places__option--active":l.value===o.value}),tabIndex:0,children:o.label},o.value))})]})}),Y=i.memo(()=>{const s=L(),a=y(),[t,c]=i.useState(null),r=i.useCallback(n=>{c(n)},[]),l=g();return i.useEffect(()=>{l&&a(R(l))},[a,l]),e.jsxs("div",{className:"page page--gray page--main",children:[e.jsx(w,{}),(s==null?void 0:s.length)===0?e.jsxs("main",{className:"page__main page__main--index page__main--index-empty",children:[e.jsx("h1",{className:"visually-hidden",children:"Cities"}),e.jsx(x,{}),e.jsx("div",{className:"cities",children:e.jsxs("div",{className:"cities__places-container cities__places-container--empty container",children:[e.jsx("section",{className:"cities__no-places",children:e.jsxs("div",{className:"cities__status-wrapper tabs__content",children:[e.jsx("b",{className:"cities__status",children:"No places to stay available"}),e.jsx("p",{className:"cities__status-description",children:"We could not find any property available at the moment in Dusseldorf"})]})}),e.jsx("div",{className:"cities__right-section"})]})})]}):e.jsxs("main",{className:"page__main page__main--index",children:[e.jsx("h1",{className:"visually-hidden",children:"Cities"}),e.jsx(x,{}),e.jsx("div",{className:"cities",children:e.jsxs("div",{className:"cities__places-container container",children:[e.jsxs("section",{className:"cities__places places",children:[e.jsx("h2",{className:"visually-hidden",children:"Places"}),e.jsxs("b",{className:"places__found",children:[s.length," places to stay in"," ",l]}),e.jsx(T,{}),e.jsx("div",{className:"cities__places-list places__list tabs__content",children:e.jsx(k,{offers:s,onActiveOffer:r})})]}),e.jsx("div",{className:"cities__right-section",children:e.jsx(E,{city:l,offers:s,selectedOffer:t})})]})})]})]})});export{Y as default};
