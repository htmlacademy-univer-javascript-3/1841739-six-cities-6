import{r as t,i as g,j as e,F as _,k as p,c as w,m as x,n as b,o as j,O as N}from"./index-44835d9b.js";import{a as y,b as O,H as T}from"./Header-1ab526d3.js";import{C,s as k}from"./scrollIntoView-7bca8b6e.js";const R=t.memo(i=>{const{id:s,onPost:r}=i,[a,c]=t.useState({rating:0,comment:""}),n=g(),o=t.useCallback(l=>{l.stopPropagation(),l.preventDefault(),n&&(r==null||r({rating:a.rating,comment:a.comment,date:new Date().toISOString(),user:n,id:`${Math.random()}`}))},[n,s,r,a.comment,a.rating]),m=t.useCallback(l=>{const d=l.target.value;c(v=>({...v,comment:d}))},[]),u=t.useCallback(l=>{c(d=>({...d,rating:l}))},[]),f=t.useMemo(()=>!(a.rating===0||!a.comment||a.comment.length<50),[a.comment,a.rating]);return!n||!s?null:e.jsxs("form",{className:"reviews__form form",action:"#",method:"post",onSubmit:o,children:[e.jsx("label",{className:"reviews__label form__label",htmlFor:"review",children:"Your review"}),e.jsx(_,{className:"reviews__rating-form ",onChange:u}),e.jsx("textarea",{onChange:m,className:"reviews__textarea form__textarea",id:"review",name:"review",value:a.comment,placeholder:"Tell how was your stay, what you like and what can be improved"}),e.jsxs("div",{className:"reviews__button-wrapper",children:[e.jsxs("p",{className:"reviews__help",children:["To submit review please make sure to set"," ",e.jsx("span",{className:"reviews__star",children:"rating"})," and describe your stay with at least"," ",e.jsx("b",{className:"reviews__text-amount",children:"50 characters"}),"."]}),e.jsx("button",{className:"reviews__submit form__submit button",type:"submit",disabled:!f,children:"Submit"})]})]})});function h(i){const s=new Date(i),r=["January","February","March","April","May","June","July","August","September","October","November","December"],a=s.getFullYear(),c=r[s.getMonth()],n=s.toISOString().split("T")[0];return{month:c,year:a,dateTime:n,mothYear:`${c} ${a}`}}const S=t.memo(i=>{const{reviews:s}=i,r=t.useCallback(a=>20*a,[]);return s.length===0?null:e.jsx("ul",{className:"reviews__list",children:s.map(a=>e.jsxs("li",{className:"reviews__item",children:[e.jsxs("div",{className:"reviews__user user",children:[e.jsx("div",{className:"reviews__avatar-wrapper user__avatar-wrapper",children:e.jsx("img",{className:"reviews__avatar user__avatar",src:a.user.avatarUrl,width:"54",height:"54",alt:"Reviews avatar"})}),e.jsx("span",{className:"reviews__user-name",children:a.user.name})]}),e.jsxs("div",{className:"reviews__info",children:[e.jsx("div",{className:"reviews__rating rating",children:e.jsxs("div",{className:"reviews__stars rating__stars",children:[e.jsx("span",{style:{width:`${r(a.rating)}%`}}),e.jsx("span",{className:"visually-hidden",children:"Rating"})]})}),e.jsx("p",{className:"reviews__text",children:a.comment}),e.jsx("time",{className:"reviews__time",dateTime:h(a.date).dateTime,children:h(a.date).mothYear})]})]},a.id))})}),P=()=>[{id:"b67ddfd5-b953-4a30-8c8d-bd083cd6b62a",date:"2019-05-08T14:13:56.569Z",user:{name:"Oliver Conner",avatarUrl:"https://url-to-image/image.png",isPro:!1},comment:"A quiet cozy and picturesque that hides behind a a river by the unique lightness of Amsterdam.",rating:4},{id:"c78eefg6-c064-5b41-9d9e-ce194de7c73b",date:"2020-03-15T10:25:33.741Z",user:{name:"Sarah Johnson",avatarUrl:"img/avatar-max.jpg",isPro:!0},comment:"Amazing place with great location and wonderful host. Highly recommended for anyone visiting the city.",rating:5},{id:"d89ffgh7-d175-6c52-ae0f-df205ef8d84c",date:"2021-07-22T18:42:17.892Z",user:{name:"Mike Wilson",avatarUrl:"img/avatar-max.jpg",isPro:!1},comment:"Good value for money. The apartment was clean and well-equipped. Only minor issue was the noise from the street.",rating:3},{id:"e90gghh8-e286-7d63-bf1g-eg316fg9e95d",date:"2022-11-30T12:18:44.123Z",user:{name:"Emma Davis",avatarUrl:"img/avatar-max.jpg",isPro:!0},comment:"Perfect stay! Everything was as described. The host was very responsive and helpful. Will definitely come back.",rating:5},{id:"f01hhii9-f397-8e74-cg2h-fh427gh0fa6e",date:"2023-01-12T09:55:28.456Z",user:{name:"James Brown",avatarUrl:"img/avatar-max.jpg",isPro:!1},comment:"Nice place but could use some updates. The location is convenient for exploring the city center.",rating:3}],D=t.memo(i=>{const{id:s}=i,[r,a]=t.useState([]);t.useEffect(()=>{a(P())},[s]);const c=t.useCallback(n=>{a(o=>[...o,n])},[]);return e.jsxs("section",{className:"offer__reviews reviews",children:[e.jsxs("h2",{className:"reviews__title",children:["Reviews Â·"," ",e.jsx("span",{className:"reviews__amount",children:r.length})]}),e.jsx(S,{reviews:r}),e.jsx(R,{id:s,onPost:c})]})}),H=t.memo(()=>{const{id:i}=p(),s=w(),r=y(),a=O(),[c,n]=t.useState(null),o=t.useCallback(m=>{n(m)},[]);return t.useEffect(()=>{i&&(window.scrollTo({top:0,behavior:"smooth"}),s(x(i)))},[s,i]),t.useEffect(()=>{a&&s(b({id:a.id,city:a.city.name}))},[s,a]),a?e.jsxs("div",{className:"page",children:[e.jsx(T,{}),e.jsxs("main",{className:"page__main page__main--offer",children:[e.jsx(j,{offer:a,reviews:e.jsx(D,{id:a.id})}),e.jsx("section",{className:"offer__map map",children:e.jsx(C,{city:a.city.name,offers:r,selectedOffer:c,onPointClick:m=>{k(`#${m}`)}})}),e.jsx("div",{className:"container",children:e.jsxs("section",{className:"near-places places",children:[e.jsx("h2",{className:"near-places__title",children:"Other places in the neighbourhood"}),e.jsx("div",{className:"near-places__list places__list",children:e.jsx(N,{offers:r,onActiveOffer:o})})]})})]})]}):null});export{H as default};
